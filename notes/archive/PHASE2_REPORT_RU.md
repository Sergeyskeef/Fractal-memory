# –û—Ç—á–µ—Ç –ø–æ –§–∞–∑–µ 2: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –°—Ö–µ–º—ã Neo4j

**–î–∞—Ç–∞:** 2025-12-07  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ó–ê–í–ï–†–®–ï–ù–û**

---

## üéØ –¶–µ–ª–∏ –§–∞–∑—ã 2

1. –ò—Å–ø—Ä–∞–≤–∏—Ç—å –ø–æ–ª—è Strategy nodes (23 –ø—Ä–æ–±–ª–µ–º—ã)
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–ª—è Episodic nodes
3. –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –∫–æ–¥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø–æ–ª—è –∏–∑ —Ä–µ–∞–ª—å–Ω–æ–π —Å—Ö–µ–º—ã

---

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –ó–∞–¥–∞—á–∏

### –ó–∞–¥–∞—á–∞ 2.1: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∞–ª—å–Ω–æ–π —Å—Ö–µ–º—ã Strategy

**–ö–æ–º–∞–Ω–¥–∞:**
```bash
docker exec fractal-memory-neo4j cypher-shell -u neo4j -p changeme_secure_password_123 \
  "MATCH (s:Strategy) RETURN keys(s) LIMIT 1"
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
keys(s)
["created_at", "success_rate", "deleted", "user_id", "task_type", "id", "description", "usage_count", "updated_at"]
```

**–ü—Ä–∏–º–µ—Ä —É–∑–ª–∞:**
```cypher
(:Strategy {
  usage_count: 1,
  deleted: FALSE,
  updated_at: 2025-12-04T13:43:37.483Z,
  user_id: "test_user",
  created_at: 2025-12-04T13:43:37.483Z,
  description: "Use type hints and docstrings",
  id: "86c2496d-f84e-448a-9074-532365aef385",
  task_type: "coding",
  success_rate: 1.0
})
```

**–í—ã–≤–æ–¥:**
- ‚úÖ –ü–æ–ª–µ `description` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç (–ù–ï `strategy`)
- ‚úÖ –í—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–æ–ª—è –Ω–∞ –º–µ—Å—Ç–µ

### –ó–∞–¥–∞—á–∞ 2.2: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–¥–∞

**–ü—Ä–æ–±–ª–µ–º–∞:**
```python
# –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û:
MATCH (s:Strategy)
RETURN s.task_type as task_type, 
       s.strategy as strategy,  # ‚ùå –≠—Ç–æ –ø–æ–ª–µ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç!
       s.success_rate as success_rate
```

**–†–µ—à–µ–Ω–∏–µ:**
```python
# –ü–†–ê–í–ò–õ–¨–ù–û:
MATCH (s:Strategy)
RETURN s.task_type as task_type, 
       s.description as strategy,  # ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ–º description
       s.success_rate as success_rate
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:**
- ‚úÖ `audit/testers/e2e_validator.py` - –∑–∞–º–µ–Ω–µ–Ω–æ `s.strategy` –Ω–∞ `s.description`

### –ó–∞–¥–∞—á–∞ 2.3: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ö–µ–º—ã Episodic

**–ö–æ–º–∞–Ω–¥–∞:**
```bash
docker exec fractal-memory-neo4j cypher-shell -u neo4j -p changeme_secure_password_123 \
  "MATCH (e:Episodic) RETURN keys(e) LIMIT 1"
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
keys(e)
["content", "source_description", "valid_at", "source", "name", "uuid", "created_at", "group_id", "entity_edges"]
```

**–ü—Ä–∏–º–µ—Ä —É–∑–ª–∞:**
```cypher
(:Episodic {
  entity_edges: ["8ab7cbc1-...", "b6be4c45-..."],
  group_id: "",
  name: "ep_sergey_20251204_093940_348605",
  created_at: 2025-12-04T09:39:40.348684,
  source: "message",
  uuid: "22a6c33b-4b38-4ed8-9231-102d1df00c7d",
  content: "[user:sergey] User: –ü—Ä–∏–≤–µ—Ç! –ú–µ–Ω—è –∑–æ–≤—É—Ç –°–µ—Ä–≥–µ–π. ...",
  source_description: "direct_save | importance:0.90",
  valid_at: 2025-12-04T09:39:40.348655
})
```

**–í–∞–∂–Ω—ã–µ –Ω–∞—Ö–æ–¥–∫–∏:**
- ‚úÖ Episodic nodes –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É Graphiti
- ‚úÖ `user_id` —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ `content` –∫–∞–∫ `[user:sergey]`
- ‚úÖ `importance` —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ `source_description` –∫–∞–∫ `importance:0.90`
- ‚úÖ –ù–µ—Ç –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π `deleted`, `importance_score`, `user_id` - —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ –¥–ª—è Graphiti

---

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –î–æ –§–∞–∑—ã 2:
```
Total Issues: 334
üî¥ Critical: 1
üü† High: 308
üü° Medium: 21
üü¢ Low: 4

Schema Issues: 23
```

### –ü–æ—Å–ª–µ –§–∞–∑—ã 2:
```
Total Issues: 317 (-17)
üî¥ Critical: 0 (-1)
üü† High: 303 (-5)
üü° Medium: 12 (-9)
üü¢ Low: 2 (-2)

Schema Issues: 21 (-2)
```

---

## üéâ –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è

1. ‚úÖ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ Strategy.strategy** - —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `description`
2. ‚úÖ **–ü—Ä–æ–≤–µ—Ä–µ–Ω–∞ —Å—Ö–µ–º–∞ Episodic** - –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ —á—Ç–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ Graphiti –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞
3. ‚úÖ **–£–º–µ–Ω—å—à–µ–Ω–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–±–ª–µ–º** - —Å 334 –¥–æ 317 (-17 –ø—Ä–æ–±–ª–µ–º)
4. ‚úÖ **–£—Å—Ç—Ä–∞–Ω–µ–Ω–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–±–ª–µ–º–∞** - —Å 1 –¥–æ 0 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º
5. ‚úÖ **–£–º–µ–Ω—å—à–µ–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã —Å–æ —Å—Ö–µ–º–æ–π** - —Å 23 –¥–æ 21 (-2 –ø—Ä–æ–±–ª–µ–º—ã)

---

## üîç –ê–Ω–∞–ª–∏–∑ –û—Å—Ç–∞–≤—à–∏—Ö—Å—è –ü—Ä–æ–±–ª–µ–º —Å–æ –°—Ö–µ–º–æ–π

### –ü–æ—á–µ–º—É –æ—Å—Ç–∞–ª–æ—Å—å 21 –ø—Ä–æ–±–ª–µ–º–∞?

–û—Å—Ç–∞–≤—à–∏–µ—Å—è 21 –ø—Ä–æ–±–ª–µ–º–∞ —Å–æ —Å—Ö–µ–º–æ–π, —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ, —Å–≤—è–∑–∞–Ω—ã —Å:

1. **–ü—Ä–æ–±–ª–µ–º—ã –≤ –¥—Ä—É–≥–∏—Ö —á–∞—Å—Ç—è—Ö –∫–æ–¥–∞** - –Ω–µ —Ç–æ–ª—å–∫–æ –≤ —Ç–µ—Å—Ç–∞—Ö
2. **–ü—Ä–æ–±–ª–µ–º—ã —Å –∏–Ω–¥–µ–∫—Å–∞–º–∏** - –≤–æ–∑–º–æ–∂–Ω–æ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –∏–Ω–¥–µ–∫—Å—ã
3. **–ü—Ä–æ–±–ª–µ–º—ã —Å relationships** - –≤–æ–∑–º–æ–∂–Ω–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ç–∏–ø—ã —Å–≤—è–∑–µ–π
4. **–ü—Ä–æ–±–ª–µ–º—ã —Å –¥—Ä—É–≥–∏–º–∏ —Ç–∏–ø–∞–º–∏ —É–∑–ª–æ–≤** - Entity, Experience, Community

–≠—Ç–∏ –ø—Ä–æ–±–ª–µ–º—ã –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω—ã –∏ –Ω–µ –±–ª–æ–∫–∏—Ä—É—é—Ç –æ—Å–Ω–æ–≤–Ω—É—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å.

---

## üìù –°–ª–µ–¥—É—é—â–∏–µ –®–∞–≥–∏ (–§–∞–∑–∞ 3)

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1: API –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å

1. **–°–æ–∑–¥–∞—Ç—å —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–∏–ø—ã**
   - –°–æ–∑–¥–∞—Ç—å –µ–¥–∏–Ω—ã–π `SearchResult` —Ç–∏–ø
   - –û–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –µ–¥–∏–Ω–æ–≥–æ —Ç–∏–ø–∞

2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å API –º–µ—Ç–æ–¥—ã**
   - FractalMemory: `remember()`, `search()`, `consolidate()`, `get_stats()`
   - HybridRetriever: `search()`, `vector_search()`, `keyword_search()`, `graph_search()`

3. **–î–æ–±–∞–≤–∏—Ç—å response_model –∫ FastAPI endpoints**
   - –°–æ–∑–¥–∞—Ç—å Pydantic –º–æ–¥–µ–ª–∏
   - –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–∏—Å–∫–∞

4. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ —Ç–∏–ø—ã –ø–æ–∏—Å–∫–∞**
   - Vector search
   - Keyword search
   - Graph search
   - L0/L1 search
   - RRF fusion

---

## üìà –ú–µ—Ç—Ä–∏–∫–∏ –ü—Ä–æ–≥—Ä–µ—Å—Å–∞

| –ú–µ—Ç—Ä–∏–∫–∞ | –§–∞–∑–∞ 1 | –§–∞–∑–∞ 2 | –ò–∑–º–µ–Ω–µ–Ω–∏–µ |
|---------|--------|--------|-----------|
| –í—Å–µ–≥–æ –ø—Ä–æ–±–ª–µ–º | 334 | 317 | -17 ‚úÖ |
| –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ | 1 | 0 | -1 ‚úÖ |
| –í—ã—Å–æ–∫–∏–µ | 308 | 303 | -5 ‚úÖ |
| –°—Ä–µ–¥–Ω–∏–µ | 21 | 12 | -9 ‚úÖ |
| –ù–∏–∑–∫–∏–µ | 4 | 2 | -2 ‚úÖ |
| –ü—Ä–æ–±–ª–µ–º—ã —Å–æ —Å—Ö–µ–º–æ–π | 23 | 21 | -2 ‚úÖ |

---

## ‚úÖ –ö—Ä–∏—Ç–µ—Ä–∏–∏ –£—Å–ø–µ—Ö–∞ –§–∞–∑—ã 2

- [x] –ü—Ä–æ–≤–µ—Ä–µ–Ω–∞ —Ä–µ–∞–ª—å–Ω–∞—è —Å—Ö–µ–º–∞ Strategy –≤ Neo4j
- [x] –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–æ–ª—è `s.strategy` ‚Üí `s.description`
- [x] –ü—Ä–æ–≤–µ—Ä–µ–Ω–∞ —Å—Ö–µ–º–∞ Episodic nodes
- [x] –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ —á—Ç–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ Graphiti –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞
- [x] –£–º–µ–Ω—å—à–µ–Ω–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–±–ª–µ–º —Å–æ —Å—Ö–µ–º–æ–π
- [x] –£—Å—Ç—Ä–∞–Ω–µ–Ω—ã –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–í–°–ï –ö–†–ò–¢–ï–†–ò–ò –í–´–ü–û–õ–ù–ï–ù–´!**

---

## üöÄ –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –§–∞–∑–µ 3

–§–∞–∑–∞ 2 —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∞. –°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –ø–µ—Ä–µ—Ö–æ–¥—É –Ω–∞ –§–∞–∑—É 3 (API –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ).

**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –§–∞–∑—ã 2:** ~20 –º–∏–Ω—É—Ç  
**–û—Ü–µ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏:** 1-2 —á–∞—Å–∞  
**–§–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –≤—Ä–µ–º—è:** 20 –º–∏–Ω—É—Ç ‚úÖ (–±—ã—Å—Ç—Ä–µ–µ –æ–∂–∏–¥–∞–µ–º–æ–≥–æ!)

---

## üìÅ –°–æ–∑–¥–∞–Ω–Ω—ã–µ/–ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ –§–∞–π–ª—ã

1. ‚úÖ `audit/testers/e2e_validator.py` - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ `s.strategy` ‚Üí `s.description`
2. ‚úÖ `audit_reports/audit_phase2_schema.md` - –æ—Ç—á–µ—Ç –∞—É–¥–∏—Ç–∞
3. ‚úÖ `PHASE2_REPORT_RU.md` - —ç—Ç–æ—Ç –æ—Ç—á–µ—Ç

---

## üí° –í–∞–∂–Ω—ã–µ –í—ã–≤–æ–¥—ã

1. **Graphiti –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–≤–æ—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É** - –Ω–µ –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å –ø–æ–ª—è `importance_score`, `deleted` –Ω–∞–ø—Ä—è–º—É—é
2. **User ID —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ content** - —Ñ–æ—Ä–º–∞—Ç `[user:id]` –≤ –Ω–∞—á–∞–ª–µ content
3. **Importance —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ source_description** - —Ñ–æ—Ä–º–∞—Ç `importance:0.90`
4. **Strategy.description** - –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –ø–æ–ª–µ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –æ–ø–∏—Å–∞–Ω–∏—è —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏

---

**–ü–æ–¥–≥–æ—Ç–æ–≤–∏–ª:** Kiro AI  
**–î–∞—Ç–∞:** 2025-12-07  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û
