# Тесты фронтенда

## Структура тестов

```
tests/
├── setup.ts                    # Настройка тестового окружения
├── App.test.tsx                # Тесты главного компонента
├── services/
│   └── api.test.ts             # Тесты API клиента
├── components/
│   ├── InputArea.test.tsx      # Тесты компонента ввода
│   ├── MessageBubble.test.tsx  # Тесты компонента сообщения
│   └── StatsPanel.test.tsx     # Тесты панели статистики
└── e2e/
    ├── chat.spec.ts            # E2E тесты чата
    └── memory.spec.ts          # E2E тесты памяти
```

## Запуск тестов

### Unit тесты (Vitest)

```bash
# Все тесты
npm test

# В watch режиме
npm test -- --watch

# С покрытием
npm test -- --coverage

# UI режим
npm test -- --ui
```

### E2E тесты (Playwright)

```bash
# Установка браузеров (первый раз)
npx playwright install

# Запуск E2E тестов
npx playwright test

# В UI режиме
npx playwright test --ui

# Конкретный тест
npx playwright test chat.spec.ts
```

## Что тестируется

### Unit тесты

1. **App.test.tsx**:
   - Отображение начального сообщения
   - Загрузка и отображение статистики
   - Отправка сообщений и получение ответов
   - Обработка ошибок API
   - Обновление статистики после отправки

2. **api.test.ts**:
   - Все методы API (health, chat, getStats, getNodes, consolidate)
   - Обработка ошибок
   - Валидация ответов

3. **InputArea.test.tsx**:
   - Отправка сообщений
   - Валидация пустых сообщений
   - Блокировка во время загрузки
   - Очистка поля после отправки

4. **MessageBubble.test.tsx**:
   - Отображение сообщений пользователя и ассистента
   - Отображение метаданных
   - Форматирование времени

5. **StatsPanel.test.tsx**:
   - Отображение статистики
   - Обработка отсутствия данных
   - Кнопка консолидации

### E2E тесты

1. **chat.spec.ts**:
   - Отображение интерфейса
   - Отправка сообщений
   - Обработка ошибок
   - Индикатор загрузки

2. **memory.spec.ts**:
   - Отображение статистики
   - Фильтрация узлов по уровню
   - Консолидация памяти

## Покрытие

Цель: >70% покрытия кода тестами.

Текущее покрытие можно проверить:
```bash
npm test -- --coverage
```

